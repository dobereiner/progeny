<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function uses the linear model of pathway-responsive genes underlying
the PROGENy method. It transforms a gene expression matrix with HGNC/MGI gene
symbols in rows and sample names in columns into a pathway score matrix with
samples in rows and pathways in columns."><title>Calculate PROGENy pathway scores from gene expression — progeny • progeny</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Calculate PROGENy pathway scores from gene expression — progeny"><meta property="og:description" content="This function uses the linear model of pathway-responsive genes underlying
the PROGENy method. It transforms a gene expression matrix with HGNC/MGI gene
symbols in rows and sample names in columns into a pathway score matrix with
samples in rows and pathways in columns."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-119440867-8"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-119440867-8');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">progeny</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.17.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/progeny.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/saezlab/progeny/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://twitter.com/saezlab">
    <span class="fab fa fab fa-twitter fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://saezlab.org/">
    <span class="fas fa fas fa-university"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Calculate PROGENy pathway scores from gene expression</h1>
      <small class="dont-index">Source: <a href="https://github.com/saezlab/progeny/blob/HEAD/R/progeny-package.r" class="external-link"><code>R/progeny-package.r</code></a>, <a href="https://github.com/saezlab/progeny/blob/HEAD/R/progeny.r" class="external-link"><code>R/progeny.r</code></a></small>
      <div class="d-none name"><code>progeny.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function uses the linear model of pathway-responsive genes underlying
the PROGENy method. It transforms a gene expression matrix with HGNC/MGI gene
symbols in rows and sample names in columns into a pathway score matrix with
samples in rows and pathways in columns.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">progeny</span><span class="op">(</span></span>
<span>  <span class="va">expr</span>,</span>
<span>  scale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  organism <span class="op">=</span> <span class="st">"Human"</span>,</span>
<span>  top <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  perm <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  z_scores <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  get_nulldist <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  assay_name <span class="op">=</span> <span class="st">"RNA"</span>,</span>
<span>  return_assay <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>expr</dt>
<dd><p>A gene expression object with HGNC/MGI symbols in rows and 
samples in columns. In order to run PROGENy in single-cell 
RNAseq data, it also accepts Seurat and SingleCellExperiment 
object, taking the normalized counts for the computation.</p></dd>


<dt>scale</dt>
<dd><p>A logical value indicating whether to scale the scores of each
pathway to have a mean of zero and a standard deviation of one.
It does not apply if we use permutations.</p></dd>


<dt>organism</dt>
<dd><p>The model organism - "Human" or "Mouse"</p></dd>


<dt>top</dt>
<dd><p>The top n genes for generating the model matrix according to
significance (p-value)</p></dd>


<dt>perm</dt>
<dd><p>An interger detailing the number of permutations. No 
permutations by default (1). When Permutations larger than 1,
we compute progeny pathway scores and assesses their 
significance using a gene sampling-based permutation strategy, 
for a series of experimental samples/contrasts.</p></dd>


<dt>verbose</dt>
<dd><p>A logical value indicating whether to display a message
about the number of genes used per pathway to compute 
progeny scores (i.e. number of genes present in the 
progeny model and in the expression dataset)</p></dd>


<dt>z_scores</dt>
<dd><p>Only applies if the number of permutations is greater than 1. 
A logical value. TRUE: the z-scores will be returned for 
the pathway activity estimations. FALSE: the function returns 
a normalized z-score value between -1 and 1.</p></dd>


<dt>get_nulldist</dt>
<dd><p>Only applies if the number of permutations is greater 
than 1. A logical value. TRUE: the null distributions
generated to assess the signifance of the pathways scores 
is also returned.</p></dd>


<dt>assay_name</dt>
<dd><p>Only applies if the input is a Seurat object. It selects the
name of the assay on which Progeny will be run. Default to: 
RNA, i.e. normalized expression values.</p></dd>


<dt>return_assay</dt>
<dd><p>Only applies if the input is a Seurat object. A logical 
value indicating whether to return progeny results as a new 
assay called Progeny in the Seurat object used as input. 
Default to FALSE.</p></dd>


<dt>...</dt>
<dd><p>Additional arguments to be passed to the functions.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A matrix with samples in rows and pathways in columns. In case
              we run the method with permutations and the option get_nulldist
              to TRUE, we will get a list with two elements. The first 
              element is the matrix with the pathway activity as before. 
              The second elements is the null distributions that we generate
              to assess the signifance of the pathways scores.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The publication of the method is available at:
https://www.nature.com/articles/s41467-017-02391-6</p>
<p>The supplied expression object has to contain HGNC/MGI symbols in rows. This
will, in most cases (and how we originally used it), be either normalized
gene expression of a microarray experiment or log-transformed (and
possible variance-stabilized) counts from an RNA-seq experiment.</p>
<p>The human and mouse model matrices consists of 14 pathways and large set of 
genes with an associated p-value (p-value per gene and pathway) that accounts
for the importance of each gene on each pathway upon perturbation. 
Its coefficients are non-zero if the gene-pathway pair corresponds
to the top N genes (100 by default) that were up-regulated upon stimulation
of the pathway in a wide range of experiments. The value corresponds to the 
fitted z-score across experiments in our model fit. 
Only rows with at least one non-zero coefficient were included, as the rest 
is not used to infer pathway activity.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="progenyPerm.html">progenyPerm</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># use example gene expression matrix here, this is just for illustration</span></span></span>
<span class="r-in"><span><span class="va">gene_expression</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, </span></span>
<span class="r-in"><span><span class="st">"human_input.csv"</span>, package <span class="op">=</span> <span class="st">"progeny"</span><span class="op">)</span>, row.names <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># calculate pathway activities</span></span></span>
<span class="r-in"><span><span class="va">pathways</span> <span class="op">&lt;-</span> <span class="fu">progeny</span><span class="op">(</span><span class="va">gene_expression</span>, scale<span class="op">=</span><span class="cn">TRUE</span>, </span></span>
<span class="r-in"><span>    organism<span class="op">=</span><span class="st">"Human"</span>, top <span class="op">=</span> <span class="fl">100</span>, perm <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Michael Schubert, Aurélien Dugourd.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

