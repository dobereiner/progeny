<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Compute progeny pathway scores and assesses significance based on permutations"><title>Compute progeny pathway scores and assesses significance based on permutations — progenyPerm • progeny</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Compute progeny pathway scores and assesses significance based on permutations — progenyPerm"><meta property="og:description" content="Compute progeny pathway scores and assesses significance based on permutations"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-119440867-8"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-119440867-8');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">progeny</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.17.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/progeny.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/saezlab/progeny/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://twitter.com/saezlab">
    <span class="fab fa fab fa-twitter fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://saezlab.org/">
    <span class="fas fa fas fa-university"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Compute progeny pathway scores and assesses significance based on permutations</h1>
      <small class="dont-index">Source: <a href="https://github.com/saezlab/progeny/blob/HEAD/R/progenyPermutations.r" class="external-link"><code>R/progenyPermutations.r</code></a></small>
      <div class="d-none name"><code>progenyPerm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Compute progeny pathway scores and assesses significance based on permutations</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">progenyPerm</span><span class="op">(</span></span>
<span>  <span class="va">df</span>,</span>
<span>  <span class="va">weight_matrix</span>,</span>
<span>  k <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  z_scores <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  get_nulldist <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>df</dt>
<dd><p>A data.frame of n*m+1 dimension, where n is the number of omic
features to be considered and m is the number of samples/contrasts.
The first column should be the identifiers of the omic features. 
These identifiers must be coherent with the identifiers of the weight matrix.</p></dd>


<dt>weight_matrix</dt>
<dd><p>A progeny coefficient matrix. the first column should be
the identifiers of the omic features and should be coherent with 
the identifiers provided in df.</p></dd>


<dt>k</dt>
<dd><p>The number of permutations to be performed to generate
the null-distribution used to estimate the significance of progeny scores.  
The default value is 10000.</p></dd>


<dt>z_scores</dt>
<dd><p>if true, the z-scores will be returned for 
the pathway activity estimations. Else, the function returns 
a normalized z-score value between -1 and 1.</p></dd>


<dt>get_nulldist</dt>
<dd><p>if true, the null score distribution used for 
normalization will be returned along with the actual normalized score data 
frame.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>This function returns a list of two elements. The first element is 
a data frame of p*m+1 dimensions, where p is the number of progeny pathways,
and m is the number of samples/contrasts. Each cell represents the 
significance of a progeny pathway score for one sample/contrast. The 
significance ranges between -1 and 1. The significance is equal to x*2-1, x 
being the quantile of the progeny pathway score with respect to the null 
distribution. Thus, this significance can be interpreted as the equivalent of 
1-p.value two-sided test over an empirical distribution) with the sign 
indicating the direction of the regulation. The second element is the null 
distribution list (a null distribution is generated for each sample/contrast).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># use example gene expression matrix</span></span></span>
<span class="r-in"><span><span class="va">gene_expression</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, </span></span>
<span class="r-in"><span><span class="st">"human_input.csv"</span>, package <span class="op">=</span> <span class="st">"progeny"</span><span class="op">)</span>, row.names <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># calculate pathway activities</span></span></span>
<span class="r-in"><span><span class="fu"><a href="progeny.html">progeny</a></span><span class="op">(</span><span class="va">gene_expression</span>, scale<span class="op">=</span><span class="cn">TRUE</span>, organism<span class="op">=</span><span class="st">"Human"</span>, top<span class="op">=</span><span class="fl">100</span>, perm<span class="op">=</span><span class="fl">10000</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Androgen   EGFR Estrogen Hypoxia JAK.STAT   MAPK    NFkB    p53</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SRR1039508  -0.8380 0.1996  -0.3470  0.9996   0.7718 0.4066 -0.5552 0.9240</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SRR1039509  -0.4918 0.0608  -0.6360  0.9998   0.4858 0.3284 -0.4426 0.8778</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SRR1039512  -0.7836 0.2158  -0.4054  0.9996   0.6992 0.4132 -0.4322 0.9230</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SRR1039513  -0.4372 0.0790  -0.6722  1.0000   0.6724 0.4352 -0.4490 0.7916</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SRR1039516  -0.7578 0.2614  -0.2944  0.9992   0.6132 0.4200 -0.3042 0.9276</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SRR1039517  -0.5104 0.5540  -0.6566  1.0000   0.4672 0.7292 -0.3776 0.8090</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SRR1039520  -0.8056 0.3332  -0.3886  0.9994   0.6094 0.5606 -0.6314 0.9022</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SRR1039521  -0.3562 0.1490  -0.6650  0.9994   0.4996 0.5776 -0.6296 0.7778</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               PI3K   TGFb    TNFa   Trail    VEGF     WNT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SRR1039508  0.1660 0.5416 -0.5988 -0.3570  0.0432 -0.1070</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SRR1039509  0.0984 0.7620 -0.4628 -0.3012  0.0508 -0.1712</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SRR1039512  0.1418 0.6930 -0.4706 -0.3462  0.0842 -0.1586</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SRR1039513 -0.0706 0.8240 -0.4828 -0.2668  0.0958 -0.3054</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SRR1039516  0.1706 0.6926 -0.3564 -0.3356  0.2734 -0.3268</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SRR1039517  0.3604 0.8662 -0.4248 -0.3586  0.2530 -0.4108</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SRR1039520  0.1788 0.6872 -0.6702 -0.2790 -0.0824 -0.1208</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SRR1039521  0.0350 0.8092 -0.6476 -0.2630 -0.0724 -0.3158</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Michael Schubert, Aurélien Dugourd.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

